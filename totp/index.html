<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.3"/><style data-href="/styles.6feab84a9be0f501541c.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100;0,300;0,400;0,800;1,100;1,300;1,400;1,800&display=swap);main{padding:3rem 0 4rem}.post-module--article--e2e17{margin-bottom:3rem}.post-module--article-header--b0ac9{margin-bottom:4rem}.post-module--article-title--0635e{font-size:2.4rem;line-height:140%;margin-bottom:.6rem}.post-module--article--e2e17 .post-module--date--e1212{display:block;font-size:.8rem}.post-module--tags--03a55{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start}.post-module--tags--03a55 .post-module--tag--72980{background:var(--white-2);border-radius:15px;color:var(--gray-4);cursor:pointer;display:block;font-size:.7rem;line-height:1.3rem;margin:0 .5rem 0 0;padding:0 .8rem}.post-module--content--64591 *{line-height:180%}.post-module--content--64591 p{margin:0 0 1.75rem;padding:0}.post-module--content--64591 h1{font-size:2rem}.post-module--content--64591 h2{font-size:1.8rem}.post-module--content--64591 h3{font-size:1.6rem}.post-module--content--64591 h4{font-size:1.4rem}.post-module--content--64591 h5{font-size:1.2rem}.post-module--content--64591 h6{font-size:1rem}.post-module--content--64591 h1,.post-module--content--64591 h2,.post-module--content--64591 h3,.post-module--content--64591 h4,.post-module--content--64591 h5,.post-module--content--64591 h6{margin:1.75rem 0}.post-module--content--64591 blockquote{border-left:.3rem solid var(--white-2);font-style:italic;font-weight:100;margin-bottom:1.75rem;padding-left:1.42188rem}.post-module--content--64591 strong{font-weight:700}.post-module--content--64591 ul{margin-bottom:1.75rem;margin-left:1rem}.post-module--content--64591 ol{margin-bottom:1.75rem;margin-left:1.75rem}.post-module--content--64591 ol * ol,.post-module--content--64591 ul * ul{margin-bottom:0;margin-left:1rem}.post-module--content--64591 table{border-collapse:collapse;margin:1rem 0;max-width:100%;width:100%}.post-module--content--64591 table th{background-color:var(--gray-3);border:1px solid var(--gray-5);color:var(--white-2)}.post-module--content--64591 table *{border:1px solid var(--gray-3);padding:.2rem}.post-module--content--64591 img{margin:1rem 0;max-width:100%}.post-module--content--64591 code,.post-module--content--64591 code *,.post-module--content--64591 pre,.post-module--content--64591 pre *{line-height:150%!important}#md-content a{border-bottom:1px solid cyan!important;color:cyan!important}.token.operator{background:transparent!important}.gatsby-highlight{margin:3rem 0!important;padding:.5rem!important}hr{border:none!important;border-top:2px dashed var(--white-2)!important;margin-bottom:1.75rem!important}:root{--gray-1:#3f3f3f;--gray-2:#32353a;--gray-3:#25282c;--gray-4:#151618;--gray-5:#151618;--gray-6:#111;--white-1:#eee;--white-2:#a9abb3}*{-webkit-user-drag:none;-moz-window-dragging:none;-webkit-tap-highlight-color:transparent;font-family:inherit;margin:0;padding:0;text-decoration:none}* img{max-width:100%}body,html{background-color:var(--gray-6);background-color:var(--gray-5);color:var(--white-2);font-family:JetBrains Mono,monospace;line-height:2rem}main{margin:0 auto;max-width:650px;padding:3rem 0}.blog-module--articles--c2662{display:grid;margin:4rem 0 3rem;row-gap:2rem}.blog-module--articles--c2662 .blog-module--article--74ac1{background:var(--gray-3);border-radius:15px;padding:2rem;transition:all .2s ease-in-out}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded,.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded a{color:var(--white-2);font-size:1.4rem;font-style:italic;font-weight:100;line-height:130%}.blog-module--articles--c2662 .blog-module--article--74ac1:hover{transform:scale(1.05)}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--date--9de28{display:block;font-size:.8rem}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--tags--7ea75{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--tags--7ea75 .blog-module--tag--559c5{background:var(--white-2);border-radius:15px;color:var(--gray-4);cursor:pointer;display:block;font-size:.7rem;line-height:1.3rem;margin:0 .5rem .3rem 0;padding:0 .8rem}@media screen and (max-width:750px){body{padding:1.5rem}}@media screen and (max-width:550px){.blog-module--articles--c2662{row-gap:1.2rem}.blog-module--articles--c2662,main{margin:0;padding:0}main{padding-bottom:1rem}}@media screen and (max-width:350px){.blog-module--articles--c2662,main{margin:0;padding:0}main{padding-bottom:1rem}.blog-module--articles--c2662{margin:2rem 0 3rem;row-gap:1.2rem}.blog-module--article--74ac1{padding:1.2rem}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded,.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded a{font-size:1rem}}</style><style data-styled="" data-styled-version="6.1.8"></style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=7292c6b3b553e8b53f5b3362fe15d2ac" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link href="https://fonts.googleapis.com/css?family=JetBrains+Mono:100,300,400,800&amp;display=swap" rel="stylesheet"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><title>TOTP - MFA made simple | Fasil Marshooq</title><meta name="description" content="A blog about software development and other cool stuff."/><meta property="og:title" content="TOTP - MFA made simple"/><meta property="og:description" content="A blog about software development and other cool stuff."/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="@fasilmarshooq"/><meta name="twitter:title" content="TOTP - MFA made simple"/><meta name="twitter:description" content="A blog about software development and other cool stuff."/><header><a href="/">Fasil Marshooq</a></header><section class="post-module--article--e2e17"><div class="post-module--article-header--b0ac9"><h2 class="post-module--article-title--0635e">TOTP - MFA made simple</h2><small class="post-module--date--e1212">September 12, 2024</small><div class="post-module--tags--03a55"><a class="post-module--tag--72980" href="/tags/tech/">tech</a><a class="post-module--tag--72980" href="/tags/.Net/">.Net</a><a class="post-module--tag--72980" href="/tags/security/">security</a></div></div><div class="post-module--content--64591" id="md-content" itemProp="articleBody"><p>Basic Authentication (just username and password) has become increasingly insecure, as it can be easily compromised through phishing, brute force attacks, or data breaches. Let&#x27;s face it: all systems have security flaws, but we should make it difficult for attackers.</p>
<p>So, what can we do? Well, we can do many things, but the easiest go-to answer is &quot;Multi-Factor Authentication&quot; (MFA).</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 861px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQ0lEQVR42o2T30tTYRjH95dE910HQbfdhBBGUBDdBUkQsqycQiUNRSGoLsRGBkm/0NymbdRR09LtnK08Tsdm0lo6wblN3UQ224+zHT9t53iscEFfeHnf5+F5v3y/z/u8pr29PWrIpNMIgoDHK1IoFPgTBzWZDB6PB1mWtRUIBAiFQoiiqMU1mIziGkksFiOzlURRFOqhUqmQSqWIRqNabWw1RiqZJB6Ps7GxYRCqqGpFC9bCAn5nOz+zW7oyVeV/YIj6S2G5mCU40c2759fYXI/sF6p1L6uqqq3dbJp8Pqflauo1wtSKj4i/n5DQgX/Uwue3Fhaneoh8eUE2EzNYDqnZ2U7wynqePvNpfizp/as5NcmCFa+jFXGkHa/9OtKwGdHZxozdTHR+8JAloz1j7pc8vHOOgVunsLU0UijmdIWSsxXJfgOf6zaz7zvxVYnEN81IjpsszvT+s1+ZzBZj9m5c1ga6Go8y+sSqE3qGW/jm62e2alUcbEIavEKwan/W3UHYYzuk0EBJKSGNP0V2NmO7epx7F09SLOYxTQ81sxpyEZ7oRHx9GWmoiYhkQx7rZsk/UIdQPyulXVwDZhwPLtDWcATLpROUaoRhbx+BqV6Ck/eZ/9DD16rNwOQjZKGL7eRiXYW1KCS7edx1lv67ZzA3HsP7ya1bzu1UhzIeZnnBQXJZJPH9I9GFETbX5qtzWK47d+WywozQS2p9ibnxZ8xNj/x+ZWPWdncS5HOb2q7sv1i93hl5RdG/ZzQ4STqxcpD/BU2cVh1ZBm3VAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="dog-mfa"
        title=""
        src="/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png"
        srcset="/static/417717973f4fc39ca911b8d8f02100de/5a46d/mfa-dog.png 300w,
/static/417717973f4fc39ca911b8d8f02100de/0a47e/mfa-dog.png 600w,
/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png 861w"
        sizes="(max-width: 861px) 100vw, 861px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<br/>
<p>Attention 🚨 - MFA is not a replacement for allowing users to create weak passwords.</p>
<p>There are multiple ways to enable MFA. Let&#x27;s explore a few of them.</p>
<h3>Email Based OTP</h3>
<p>An OTP will be delivered to the registered email. Accessibility is a pro here, as most users have an email account. However, you need to set up SMTP, store the OTP to validate it later, and be aware that emails can be compromised.</p>
<h3>Sms Based Otp</h3>
<p>An OTP will be delivered to the registered mobile number. It&#x27;s easy to use and poses a lesser security risk than email-based OTPs. But... there are high costs involved.</p>
<p>So, this leaves us to select a solution that should be cost-effective and easy to use.</p>
<h3>Introducing TOTP!!!</h3>
<p>Time-Based One-Time Passwords (TOTP) are randomized numeric codes generated by authenticator apps like <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en">Google Authenticator</a> and <a href="https://play.google.com/store/apps/details?id=com.azure.authenticator&amp;hl=en">Microsoft Authenticator</a>. These codes are generated based on a shared secret and a time counter, which means a new OTP is typically generated every 30 seconds. The OTP is valid only for the allotted time window, beyond which it becomes redundant, preventing OTP reuse.</p>
<h4>Fun Fact!</h4>
<p>The first TOTP authentication system was developed, patented, and marketed by RSA Security. Later, the Initiative for Open Authentication (OATH) developed its own variant of TOTP, which it made freely available. I hope many of you have seen the image below 😆</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 567px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADDklEQVR42h2S3U+bdRiG+zd44oEnHixLduCM07iZGIlOnJtkLOg255jZxK3MdQwLZUvD6Bh1VRS71WKtUFre8tLvljJoLbRQaPnoS2nQURiZgrTrYPsnLn9ycOfJc/DcuXI/t8psvovd3oMk/YrP308kMsjYmIdEIsTU1CizszHm5xIsLiTJ5VJ7WliYZH5+gkw2QXomzsTkGGOxCKERLyqr1YTTacHn6yMcdhGP+5mejpLJxFgUR3lliiVlmnx+hsLyLMt7mhF7GkVJMzefEqYJJpPjxGIjqOy//4Qs2wiFnCSEWSTixCN22W3D7+0nlYyyspJlrZjj8brCxnqetTWF1dVFHv2Vo1BYQFnKCtrUnqlqYOCBoOsnHvNht91Dd0vDJU0rVZ/e4P0vdOgMXQw47Qx5JBGJjD8wTCDowR8cxivk8Q8jDUuCcpJsZgqVJFkJh1xILjPfaM6jaWxCfaSOa4dO0fLaCT6sukJb1/d09/yIvrOTNoOBplt6NK03uaptQd10g9b2doKRAEouKwgdP9PTredS/Seor12m7tiXRA+8iVJ9lPSRdzlx8BzNxgcYuu7wxkc1vH70OPveqeLVQ4d5Zf8BXtq3nw9qT+KW3Sz+b2j6rg3rfQNn6t6jsbGBjz+7zuljak5XX+Vi/W3eOtVB8x0LFpuFr5q1qFt0nG1QU32ugaras9Qcr+FCw9c43ZJ40hyqXus9un9ox3i3mSuXz/CtvpO3z3fwcrWBgxfuU6u1Yu13EomGiSdiJCZiDIdGuGj08nmHyLTpJl3aDvpkWbRAQeV2/0Y0KpNKRTGZtGh1GnS3jdRfN9Ko78HmcIjg5T0FwwGRVZCAmLLXI54hMyhLSJ4hZrMzLBfyqFyuXgKBQcbHg6TTYwwN9WK2mLDZzUjuPsb/GGXjSZFy+W8qz7bY2dnm+e5TXryosPu8zLOdEqXSFmvrRZS8IHQ4fsHrdfJw1EcyOUpOlHUpnxHdyrBaLFAq/0Olsim0JY7/ZWd3W8wyTyvbbJc22dx8wuONIn8+WiGXV/gPnGVyF/I3QJcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="dog-mfa"
        title=""
        src="/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png"
        srcset="/static/6b708138ce1112066c9bc2133d58fef3/5a46d/rsa.png 300w,
/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png 567w"
        sizes="(max-width: 567px) 100vw, 567px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<br/>
<p>Let&#x27;s see how we can implement one. I&#x27;m using C# here as an example, but it should
be pretty much the same across platforms.</p>
<p>Below is the basic user journey for registration and authentication:</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 373px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 129.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADRUlEQVR42q1V7XaqMBD0/Z+t/dEPRUWFAIHwraKIVdm7sxRapb33z805aTCZbLI7M+mE/nOb4M/pdKLNxiWlfPL9gIIgpDTNR+C2banHh5GhMDSU58U44OVyIROnFCc5pVlB2+2edrvqLwEbDhhTUWypLHd3axN8XK9XzMgk+u12G/pjO5/Pgu9wV8F8fHzIpSQgJoIg4OtHMvq+T0mSkOd5ktb3Bmye56S1FpxSinQYkjGG92S83tIEkRFguVzS09MTvby80HQ65ZpuSHl6lDIOent7o/l8LuNsNqPFYkHrjeoCIoXD4SCFtiyL1uu1nNy2N/KDaKgNGlLNsryrOd8KB6dpKhjXDXj91tUwZkK0NuSqQE4KI07ZDyky6aiGIA1Yz9dk2w6nHMvBJs6+WO5b0zTM8D1rvzXcsiy3Yx1iI9JF6mVZcsobYa2fe6xhXx5gLWtBdX2Subquu4DYvFqthBiwF0WRjCj+fLHqQw0s92Q4jiOEoObT93eacXAJiKuDUQS17aVswGhZMx43dzcEKdvtliWmBf/8/Cx7y7KQul8uV5oAFImNIrllkmbyW+uISdIjHcZxwikeZbTtFbulpP2+oo3jy7qQgjocjw3lbCXDzB7rhqrqKPOPDXOwJSwHu1aHmm9d8f7TF8tfHq0pTTqptD/YrsdCoyAGmfRWHVjGD6SK2kRRyDVcCINZlomIH4MBd2J5lTw6jpJ0d7vdICEhZToFAbY4BcWGA15fX5m55aiGcAZ8DBV4nhJVdAoxQpoEBAi3CtnoCFYUhTwCwQ/W2+/3HCCWgC5LByxX1V5cNbCM4qZZySDNKdvyDYDywlHKxiSypkMj9gzZerAfFIH1zwf2yu64iBxgPXw3zVnM/thwAeDBdp6XggFe3tRHL8M+0ecb+C8vw5bQ7sjLiIyaVVUldVPKkzqBzZxF+5gysGAWo6vUgIUicAfxMswNmYA913WF6aaBzhJ5NL+nCzVgHX6Hj/HKw9cWK0JqiKsfjwcOWonZ4WUw2LZXCrS5Sx3fCKD4ULzSzifLwPtMkDyw0FbPXMyPZNdTCjUeTjNKGV4fcOwqKAR29fzo3nqIfgGD3PGN/hMxLZegx33v/b/RP3Ffyjb/MI5QAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mfa-flow"
        title=""
        src="/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png"
        srcset="/static/4cc3ba47e58391a778550062601ba2c0/5a46d/mfa-flow.png 300w,
/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png 373w"
        sizes="(max-width: 373px) 100vw, 373px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<br/>
<div style="position:relative"><button style="position:absolute;top:10px;right:10px;background:grey;color:white;border:none;border-radius:4px;padding:2px 5px;cursor:pointer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><pre class="prism-code language-csharp" style="color:#9CDCFE;background-color:#1E1E1E;white-space:pre-wrap;word-wrap:break-word;padding:10px"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">using</span><span class="token plain"> </span><span class="token namespace">OtpNet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">using</span><span class="token plain"> </span><span class="token namespace">QRCoder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div>
<br/>
<p>We are using <a href="https://github.com/kspearrin/Otp.NET?tab=readme-ov-file#totp-timed-one-time-password">otp.net</a>
and <a href="https://github.com/codebude/QRCoder">QRCode</a> here</p>
<div style="position:relative"><button style="position:absolute;top:10px;right:10px;background:grey;color:white;border:none;border-radius:4px;padding:2px 5px;cursor:pointer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><pre class="prism-code language-csharp" style="color:#9CDCFE;background-color:#1E1E1E;white-space:pre-wrap;word-wrap:break-word;padding:10px"><div class="token-line" style="color:#9CDCFE"><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> secret </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Base32Encoding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">ToString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                KeyGeneration</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">GenerateRandomKey</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div>
<p><br/> The secret is generated using <code style="background-color:#2d2d2d;color:#f8f8f2;padding:0.2em 0.4em;border-radius:3px">KeyGeneration.GenerateRandomKey</code>. I would
prefer one secret per user and store it securely after encrypting it using AES
or other popular algorithms.</p>
<div style="position:relative"><button style="position:absolute;top:10px;right:10px;background:grey;color:white;border:none;border-radius:4px;padding:2px 5px;cursor:pointer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><pre class="prism-code language-csharp" style="color:#9CDCFE;background-color:#1E1E1E;white-space:pre-wrap;word-wrap:break-word;padding:10px"><div class="token-line" style="color:#9CDCFE"><span class="token return-type class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">GenerateQrCodeUri</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> email</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> secret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> issuer </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;my amazing app&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> uri </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token interpolation-string string" style="color:rgb(206, 145, 120)">$&quot;otpauth://totp/</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token interpolation-string interpolation expression language-csharp">issuer</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token interpolation-string string" style="color:rgb(206, 145, 120)">:</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token interpolation-string interpolation expression language-csharp">email</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token interpolation-string string" style="color:rgb(206, 145, 120)">?secret=</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token interpolation-string interpolation expression language-csharp">secret</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token interpolation-string string" style="color:rgb(206, 145, 120)">&amp;issuer=</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token interpolation-string interpolation expression language-csharp">issuer</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token interpolation-string string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">using</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> qrGenerator </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(78, 201, 176)">QRCodeGenerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    	</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> qrCodeData </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> qrGenerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">CreateQrCode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> QRCodeGenerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ECCLevel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Q</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    	</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> qrCode </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(78, 201, 176)">Base64QRCode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">qrCodeData</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    	</span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> qrCode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">GetGraphic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></div></pre></div>
<p><br/> With the help of QRCoder, we can generate a QR code. Below is the output
from the above code, which you can scan using authenticator apps.</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 541px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 97.66666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD5klEQVR42j1V5yv9URg/f4lXSkrKKxQhys5O9p4Z2Xvvlb33HhmRV0TIeGErvCQlm2Rmffw+j/rd+nbvPfec53k+61z18/OD+/t73Nzc4OnpCV9fX3h8fMT19TW+v7/x+fmJ5+dnvL6+yueHhwe8v7/L8/HxIeu3t7dynt8VD2ZkZCAuLg55eXno7u5GYWEh/Pz8sLS0hLCwMPk9Pj4eubm5MDQ0RE5ODnx9fRESEoKUlBRkZ2cjJiYGCwsLfwUzMzNhZWWF+vp6zM/PS3EW4rqXlxc8PDygpaWFqKgoaVZUVARtbW2kpqZienpa9vBZXl6GIsyamhqZrre3Fz09PdK1ra0NCQkJGB4eRm1trexxdHREbGws5ubmYGlpifz8fGxubmJwcBAlJSXY3t6Gent7Q1ZWFkZGRqSYubk50tLSpKCFhQWam5sRERGBwMBAuLu7IzExEXV1dTAxMcHQ0BDGx8fR19cnRc/Pz6FI7tTUFBoaGlBQUCAFRkdH5dDu7q5sZkOusSGhcXKiYGM28/b2RmtrK1ZWVqCoGqdxc3NDS0uLEN/V1YWtrS0pHh4ejvT0dKGkrKwMnZ2dAtnJyUk4JmxTU1MRjvDVxcWFLJKbiooKIbqjo0OKswAhbWxsoKqqCnZ2dkhKSoKRkRHGxsZQXFyMnZ0daRIcHCyIhMPFxUUZOSAgQN55mErz8PHxMdrb26UBiS8tLUVTUxPKy8txdHQk63t7e/J+d3f3xyEhcBO9Fh0dLRtZmELQMpWVlTINrWJmZibwKRCpoR+pPpsyFIpJIYfW1tbiL26YmZmRAyScMMgr+QoKCpIG9F5/f79AJxoXFxfo6+vj5OQE6vLyUkzs4OAgG/gjFSdkW1tbTExMSDN/f3+hhGuhoaEYGBiQxLAxLUO+hUPmj2rOzs6KxzQ0NIR8HR0dKZKcnCyxouc4Oe1D+IRJ6xgYGAhdtBmbKwafBLMboZFHZpPKOzs7S0KoPqcigsbGRrk4KBBRkAJGlrleW1uD4k1hb28PHx+f/4alBeg9QuUaI8n4kZrJyUkpzokiIyNlWj6urq5y4yj8e1E1eonmpMoUg4mgSOTM09NTLgUmiVbidNXV1SIM97EYmx8cHEC9vLyIguSHeeZhHuAUvMI4BbnlpKSAhXR1dYUSNmcsiYpc7+/vQ11dXUlBRo/cERJF4i3Dz1wjTxSI4tCbLEQK2JzXHgVicpg6uQ8Jg/KzMIUxNjaGnp6eTMXNmpqasLGxkfuQU1MMckx12YB2oqgMiURvfX1d8soI8e+A8JkecnJ4eChQeNednZ3JPvptdXUVp6enojjF4I1FgX8Bwncu4N1obTYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mfa-qr"
        title=""
        src="/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png"
        srcset="/static/1f29c072d81b5d5a7d28e42c41e8859d/5a46d/mfa-qr.png 300w,
/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png 541w"
        sizes="(max-width: 541px) 100vw, 541px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<br/>
<p>Once you have scanned the QR code, it will appear in authenticator apps like the one below. Oh yeah, the screenshot below is taken from the Chrome Google Authenticator extension.</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 818px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABxElEQVR42o1Ti47aMBD0//9Mf6BSTyq05bhW4VpCgMLlSOJAnBd5OCThmO66KULqnVpLo3Xs9exjNuL+m4UgkHCfd0izHCpOECcpYrLbJxfL1YrsE35utoSN8UvSFEmWISa7oTs/CHCIFMaTKcSaHoVSEmkAXpfLZbAvcF0Xj48zrNdrOMsVLMsy5H/W+XyGpLdhGKJpNGZzG8JZ/EDX9dC6IWjopkHNllDX9e+zmz3boiiuqKoKZVmia1vM7QWEv12grGpEUYTDYW+iKRUhInAGXdeh73v0FNTYG5xOJ0N4PB5NMN/3IWxrioYuwlBChntIKp174lEpPVV/fqHy8fpiwjiOkVE/ee95HsT84ROSDpgrDStqMPJrjAONZdpiEpR4t0yxzU5DX99gHs6vhOz+ParxWWq8dwvc7Uo8hDV2RYuxV8LNXydkAa+g71gpiMVsakTwfQ+O48D3nrGn8kMZoKr1bQJ/JzZEsG0bKY1QTqWLr19GpocsAo/AgcRJEp7FmBTV6Kj5LQnTvQEWh3vISvM7Mfn4wWTIEVitPM+REfI8M2fs9C8wIUNRMuJ+dGfGhtXiy5T+kpQtkf0vksFfKYVfXr1Bt0hF+ewAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mfa-auth"
        title=""
        src="/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png"
        srcset="/static/325fb1a30674f08b7727b1d6b5727f76/5a46d/mfa-auth.png 300w,
/static/325fb1a30674f08b7727b1d6b5727f76/0a47e/mfa-auth.png 600w,
/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png 818w"
        sizes="(max-width: 818px) 100vw, 818px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<br/>
<p>Now you have a time-based OTP. Let&#x27;s see how to validate it.</p>
<div style="position:relative"><button style="position:absolute;top:10px;right:10px;background:grey;color:white;border:none;border-radius:4px;padding:2px 5px;cursor:pointer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><pre class="prism-code language-csharp" style="color:#9CDCFE;background-color:#1E1E1E;white-space:pre-wrap;word-wrap:break-word;padding:10px"><div class="token-line" style="color:#9CDCFE"><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> secret </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;my secure secret&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> code </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;650260&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> isValid </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ValidateTotpCode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">secret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">code</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">isValid</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">Dump</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token return-type class-name keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ValidateTotpCode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> secret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> totp </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(78, 201, 176)">Totp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Base32Encoding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">ToBytes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">secret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> totp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">VerifyTotp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">code</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">out</span><span class="token plain"> </span><span class="token class-name keyword" style="color:rgb(86, 156, 214)">long</span><span class="token plain"> timeStepMatched</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(78, 201, 176)">VerificationWindow</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></div></pre></div>
<br/>
<p><code style="background-color:#2d2d2d;color:#f8f8f2;padding:0.2em 0.4em;border-radius:3px">totp.VerifyTotp</code> will help us validate whether the input TOTP is valid or not.</p>
<p>Tada!!! With these easy steps, you have enabled MFA for your application.</p>
<p>Having MFA will not protect against impersonating cookies or JWTs. We will see how to make your JWT more secure in upcoming posts.</p><div style="margin-top:50px"><div style="height:2px;background:linear-gradient(to right, transparent, grey, transparent);margin:10px 10px"></div></div></div></section><footer><p>© <!-- -->2025</p></footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KT6SX03PDB"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-KT6SX03PDB',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-KT6SX03PDB', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/totp/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-2822b06238e921b96935.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-5e418954df96c0daea16.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-f4ec0d28cb02743d1b15.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-create-slack-bot-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-create-slack-bot-mdx-d88f37f70357f4066141.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-db-size-estimation-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-db-size-estimation-mdx-f9c329ebecccedb53da5.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-netpad-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-netpad-mdx-af335997669e151f0749.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-physics-for-software-engineers-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-physics-for-software-engineers-mdx-0de1892452900fce9235.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-pnpm-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-pnpm-mdx-5b2554deb60643675d5a.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-seq-monitoring-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-seq-monitoring-mdx-6baff2fb6a520c844564.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-stack-overflow-survey-2024-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-stack-overflow-survey-2024-mdx-2f422e5ab327e5c60d6b.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-totp-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-totp-mdx-94016e23a717b77fb4fe.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-your-resumes-are-read-by-machines-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-your-resumes-are-read-by-machines-mdx-1badf7e1323ef9169b5c.js\"],\"component---src-templates-tag-js\":[\"/component---src-templates-tag-js-cb229898bb72705dc28d.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="f5b470b715a87febdfd3";</script><script src="/webpack-runtime-caecc24acbfabd7d0eef.js" async></script><script src="/app-2822b06238e921b96935.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>