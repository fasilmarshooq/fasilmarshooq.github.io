<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.3"/><style data-href="/styles.6feab84a9be0f501541c.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100;0,300;0,400;0,800;1,100;1,300;1,400;1,800&display=swap);main{padding:3rem 0 4rem}.post-module--article--e2e17{margin-bottom:3rem}.post-module--article-header--b0ac9{margin-bottom:4rem}.post-module--article-title--0635e{font-size:2.4rem;line-height:140%;margin-bottom:.6rem}.post-module--article--e2e17 .post-module--date--e1212{display:block;font-size:.8rem}.post-module--tags--03a55{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start}.post-module--tags--03a55 .post-module--tag--72980{background:var(--white-2);border-radius:15px;color:var(--gray-4);cursor:pointer;display:block;font-size:.7rem;line-height:1.3rem;margin:0 .5rem 0 0;padding:0 .8rem}.post-module--content--64591 *{line-height:180%}.post-module--content--64591 p{margin:0 0 1.75rem;padding:0}.post-module--content--64591 h1{font-size:2rem}.post-module--content--64591 h2{font-size:1.8rem}.post-module--content--64591 h3{font-size:1.6rem}.post-module--content--64591 h4{font-size:1.4rem}.post-module--content--64591 h5{font-size:1.2rem}.post-module--content--64591 h6{font-size:1rem}.post-module--content--64591 h1,.post-module--content--64591 h2,.post-module--content--64591 h3,.post-module--content--64591 h4,.post-module--content--64591 h5,.post-module--content--64591 h6{margin:1.75rem 0}.post-module--content--64591 blockquote{border-left:.3rem solid var(--white-2);font-style:italic;font-weight:100;margin-bottom:1.75rem;padding-left:1.42188rem}.post-module--content--64591 strong{font-weight:700}.post-module--content--64591 ul{margin-bottom:1.75rem;margin-left:1rem}.post-module--content--64591 ol{margin-bottom:1.75rem;margin-left:1.75rem}.post-module--content--64591 ol * ol,.post-module--content--64591 ul * ul{margin-bottom:0;margin-left:1rem}.post-module--content--64591 table{border-collapse:collapse;margin:1rem 0;max-width:100%;width:100%}.post-module--content--64591 table th{background-color:var(--gray-3);border:1px solid var(--gray-5);color:var(--white-2)}.post-module--content--64591 table *{border:1px solid var(--gray-3);padding:.2rem}.post-module--content--64591 img{margin:1rem 0;max-width:100%}.post-module--content--64591 code,.post-module--content--64591 code *,.post-module--content--64591 pre,.post-module--content--64591 pre *{line-height:150%!important}#md-content a{border-bottom:1px solid cyan!important;color:cyan!important}.token.operator{background:transparent!important}.gatsby-highlight{margin:3rem 0!important;padding:.5rem!important}hr{border:none!important;border-top:2px dashed var(--white-2)!important;margin-bottom:1.75rem!important}:root{--gray-1:#3f3f3f;--gray-2:#32353a;--gray-3:#25282c;--gray-4:#151618;--gray-5:#151618;--gray-6:#111;--white-1:#eee;--white-2:#a9abb3}*{-webkit-user-drag:none;-moz-window-dragging:none;-webkit-tap-highlight-color:transparent;font-family:inherit;margin:0;padding:0;text-decoration:none}* img{max-width:100%}body,html{background-color:var(--gray-6);background-color:var(--gray-5);color:var(--white-2);font-family:JetBrains Mono,monospace;line-height:2rem}main{margin:0 auto;max-width:650px;padding:3rem 0}.blog-module--articles--c2662{display:grid;margin:4rem 0 3rem;row-gap:2rem}.blog-module--articles--c2662 .blog-module--article--74ac1{background:var(--gray-3);border-radius:15px;padding:2rem;transition:all .2s ease-in-out}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded,.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded a{color:var(--white-2);font-size:1.4rem;font-style:italic;font-weight:100;line-height:130%}.blog-module--articles--c2662 .blog-module--article--74ac1:hover{transform:scale(1.05)}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--date--9de28{display:block;font-size:.8rem}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--tags--7ea75{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--tags--7ea75 .blog-module--tag--559c5{background:var(--white-2);border-radius:15px;color:var(--gray-4);cursor:pointer;display:block;font-size:.7rem;line-height:1.3rem;margin:0 .5rem .3rem 0;padding:0 .8rem}@media screen and (max-width:750px){body{padding:1.5rem}}@media screen and (max-width:550px){.blog-module--articles--c2662{row-gap:1.2rem}.blog-module--articles--c2662,main{margin:0;padding:0}main{padding-bottom:1rem}}@media screen and (max-width:350px){.blog-module--articles--c2662,main{margin:0;padding:0}main{padding-bottom:1rem}.blog-module--articles--c2662{margin:2rem 0 3rem;row-gap:1.2rem}.blog-module--article--74ac1{padding:1.2rem}.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded,.blog-module--articles--c2662 .blog-module--article--74ac1 .blog-module--article-title--70ded a{font-size:1rem}}</style><style data-styled="" data-styled-version="6.1.8"></style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=7292c6b3b553e8b53f5b3362fe15d2ac" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=7292c6b3b553e8b53f5b3362fe15d2ac"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link href="https://fonts.googleapis.com/css?family=JetBrains+Mono:100,300,400,800&amp;display=swap" rel="stylesheet"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><title>A Rookie System Designer&#x27;s Journey - Estimating DB Size | Fasil Marshooq</title><meta name="description" content="A blog about software development and other cool stuff."/><meta property="og:title" content="A Rookie System Designer&#x27;s Journey - Estimating DB Size"/><meta property="og:description" content="A blog about software development and other cool stuff."/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="@fasilmarshooq"/><meta name="twitter:title" content="A Rookie System Designer&#x27;s Journey - Estimating DB Size"/><meta name="twitter:description" content="A blog about software development and other cool stuff."/><header><a href="/">Fasil Marshooq</a></header><section class="post-module--article--e2e17"><div class="post-module--article-header--b0ac9"><h2 class="post-module--article-title--0635e">A Rookie System Designer&#x27;s Journey - Estimating DB Size</h2><small class="post-module--date--e1212">December 19, 2024</small><div class="post-module--tags--03a55"><a class="post-module--tag--72980" href="/tags/tech/">tech</a><a class="post-module--tag--72980" href="/tags/database/">database</a><a class="post-module--tag--72980" href="/tags/postgresql/">postgresql</a><a class="post-module--tag--72980" href="/tags/system-design/">system-design</a></div></div><div class="post-module--content--64591" id="md-content" itemProp="articleBody"><p>Ever been in the hot seat when a DBA asks, &quot;What&#x27;s your DB size going to be in a year?&quot; 😎</p>
<p>At Agoda, we traditionally relied on SQL Server for our app. But let&#x27;s face it, SQL Server can be a pricey beast. So, we decided to embrace the happy elephant, PostgreSQL. Why? That&#x27;s a story for another day.</p>
<p>I was tasked with designing a highly scalable, event-driven booking search system. To give you a sense of scale, Agoda processes a few hundred bookings daily (let&#x27;s assume 200k 😎)—which means a few bookings every second!</p>
<p>Since PostgreSQL was new to our platform, our cautious DBA team didn&#x27;t want to risk it with a mission-critical service exceeding 300 GB. The burning question: Will my service exceed this limit?</p>
<p>The expectation was to have at least two years&#x27; worth of historical booking data ready at launch.</p>
<h2>The ChatGPT Consultation</h2>
<p>Like any newbie, I turned to ChatGPT and asked:</p>
<blockquote>
<p>&quot;If my PostgreSQL DB hosts a single table with a max of ten columns, one row per booking, and we get around 200k bookings per day, what&#x27;s the data size for 2 years?&quot;</p>
</blockquote>
<p>ChatGPT&#x27;s short answer: Yes, it will exceed 300 GB, with each row being 1KB. Yikes, that&#x27;s hefty!</p>
<p>But wait, how can a single row be 1KB?</p>
<h2>The Initial Calculation</h2>
<p>After some digging, I calculated the average row size:</p>
<ul>
<li>10 columns total</li>
<li>1 bigint (8 bytes)</li>
<li>3 integers (12 bytes)</li>
<li>5 timestamps (40 bytes)</li>
<li>1 int[] (assuming an average of 5 ints, 20 bytes)</li>
</ul>
<p><strong>Total estimated row size: 80 bytes.</strong></p>
<p>For two years, that&#x27;s 146,000,000 rows × 80 bytes/row = <strong>11.68 GB</strong>.</p>
<p>12 GB? Sweet! I got the green light to onboard to PostgreSQL, and my app went live.</p>
<h2>Reality Check</h2>
<p>But was I right? After all, I&#x27;m a rookie, and it&#x27;s just me and AI—a perfect evil combo, right? 🤣</p>
<p>While I wasn&#x27;t too far off, I revisited the week&#x27;s data.</p>
<p>The current DB size as I write this is <strong>780 MB</strong> for <strong>5,056,637 rows</strong> (I haven&#x27;t hydrated the historical data yet). That doesn&#x27;t add up—5,056,637 rows × 80 bytes should be 404 MB. Why am I off by almost 380 MB, nearly 50% more?</p>
<h2>The Missing Pieces</h2>
<p><strong>Surprise!</strong> The index size is 162 MB, which I didn&#x27;t factor in. But there are still 220 MB unaccounted for.</p>
<p>Ah, the average row size turned out to be <strong>130 bytes</strong>. I also overlooked row overhead (fields reserved for transaction management, tuple headers, TOAST), which is a minimum of 30 bytes.</p>
<h2>The Corrected Calculation</h2>
<p>Considering these factors, recalculating gives:</p>
<ul>
<li>146,000,000 rows × 130 bytes/row ≈ <strong>20 GB</strong></li>
<li>Plus 20% for indexes ≈ <strong>24 GB</strong></li>
</ul>
<p>That&#x27;s more than double my initial estimate.</p>
<h2>Lessons Learned</h2>
<p>It&#x27;s been a valuable learning experience for me, and I hope it is for you too.</p>
<p>These basics might just save you from a hefty AWS RDS bill someday.</p>
<p><strong>Key takeaways:</strong></p>
<ul>
<li>Always account for row overhead (minimum 30 bytes in PostgreSQL)</li>
<li>Don&#x27;t forget about index storage requirements</li>
<li>Real-world row sizes are often larger than theoretical calculations</li>
<li>Test with actual data when possible</li>
</ul>
<p>Comments are most welcome! How do you estimate your DB size? 😁</p><div style="margin-top:50px"><div style="height:2px;background:linear-gradient(to right, transparent, grey, transparent);margin:10px 10px"></div></div></div></section><footer><p>© <!-- -->2025</p></footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KT6SX03PDB"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-KT6SX03PDB',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-KT6SX03PDB', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/db-size-estimation/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-2822b06238e921b96935.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-5e418954df96c0daea16.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-f4ec0d28cb02743d1b15.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-create-slack-bot-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-create-slack-bot-mdx-d88f37f70357f4066141.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-db-size-estimation-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-db-size-estimation-mdx-f9c329ebecccedb53da5.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-netpad-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-netpad-mdx-af335997669e151f0749.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-physics-for-software-engineers-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-physics-for-software-engineers-mdx-0de1892452900fce9235.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-pnpm-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-pnpm-mdx-5b2554deb60643675d5a.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-seq-monitoring-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-seq-monitoring-mdx-6baff2fb6a520c844564.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-stack-overflow-survey-2024-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-stack-overflow-survey-2024-mdx-2f422e5ab327e5c60d6b.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-totp-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-totp-mdx-94016e23a717b77fb4fe.js\"],\"component---src-templates-blog-post-js-content-file-path-posts-your-resumes-are-read-by-machines-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-posts-your-resumes-are-read-by-machines-mdx-1badf7e1323ef9169b5c.js\"],\"component---src-templates-tag-js\":[\"/component---src-templates-tag-js-cb229898bb72705dc28d.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="f5b470b715a87febdfd3";</script><script src="/webpack-runtime-caecc24acbfabd7d0eef.js" async></script><script src="/app-2822b06238e921b96935.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>