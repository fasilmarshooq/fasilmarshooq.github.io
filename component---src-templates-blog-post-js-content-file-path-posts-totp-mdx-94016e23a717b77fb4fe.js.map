{"version":3,"file":"component---src-templates-blog-post-js-content-file-path-posts-totp-mdx-94016e23a717b77fb4fe.js","mappings":"0MAGA,SAASA,EAAkBC,GACzB,MAAMC,EAAcC,OAAOC,OAAO,CAChCC,EAAG,IACHC,KAAM,OACNC,GAAI,KACJC,EAAG,IACHC,GAAI,KACJC,IAAK,MACLC,KAAM,SACLC,EAAAA,EAAAA,KAAsBX,EAAMY,YAC/B,OAAOC,EAAAA,cAAoBA,EAAAA,SAAgB,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,+QAAgR,KAAMS,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,yHAA4H,KAAMS,EAAAA,cAAoBZ,EAAYI,KAAM,CAC/jBS,wBAAyB,CACvBC,OAAQ,ijEAER,KAAMF,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,wFAAyF,KAAMS,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,uEAAwE,KAAMS,EAAAA,cAAoBZ,EAAYK,GAAI,KAAM,mBAAoB,KAAMO,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,0OAA2O,KAAMS,EAAAA,cAAoBZ,EAAYK,GAAI,KAAM,iBAAkB,KAAMO,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,4KAA6K,KAAMS,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,0FAA2F,KAAMS,EAAAA,cAAoBZ,EAAYK,GAAI,KAAM,uBAAwB,KAAMO,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,0GAA2GS,EAAAA,cAAoBZ,EAAYM,EAAG,CAC7yCS,KAAM,8FACL,wBAAyB,QAASH,EAAAA,cAAoBZ,EAAYM,EAAG,CACtES,KAAM,+EACL,2BAA4B,wPAAyP,KAAMH,EAAAA,cAAoBZ,EAAYO,GAAI,KAAM,aAAc,KAAMK,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,uQAAwQ,KAAMS,EAAAA,cAAoBZ,EAAYI,KAAM,CACvrBS,wBAAyB,CACvBC,OAAQ,gvEAER,KAAMF,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,iIAAkI,KAAMS,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,wEAAyE,KAAMS,EAAAA,cAAoBZ,EAAYI,KAAM,CACxXS,wBAAyB,CACvBC,OAAQ,60EAER,KAAMF,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYQ,IAAK,KAAMI,EAAAA,cAAoBZ,EAAYS,KAAM,CAC1HO,UAAW,mBACV,oCAAqC,KAAMJ,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,gBAAiBS,EAAAA,cAAoBZ,EAAYM,EAAG,CAC1KS,KAAM,wFACL,WAAY,SAAUH,EAAAA,cAAoBZ,EAAYM,EAAG,CAC1DS,KAAM,uCACL,UAAW,SAAU,KAAMH,EAAAA,cAAoBZ,EAAYQ,IAAK,KAAMI,EAAAA,cAAoBZ,EAAYS,KAAM,CAC7GO,UAAW,mBACV,qHAAsH,KAAMJ,EAAAA,cAAoBZ,EAAYG,EAAG,KAAMS,EAAAA,cAAoB,MAAO,kCAAmCA,EAAAA,cAAoBZ,EAAYS,KAAM,KAAM,mCAAoC,2HAA4H,KAAMG,EAAAA,cAAoBZ,EAAYQ,IAAK,KAAMI,EAAAA,cAAoBZ,EAAYS,KAAM,CACvgBO,UAAW,mBACV,4aAAib,KAAMJ,EAAAA,cAAoBZ,EAAYG,EAAG,KAAMS,EAAAA,cAAoB,MAAO,gJAAiJ,KAAMA,EAAAA,cAAoBZ,EAAYI,KAAM,CACzrBS,wBAAyB,CACvBC,OAAQ,0hFAER,KAAMF,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,sLAAuL,KAAMS,EAAAA,cAAoBZ,EAAYI,KAAM,CACrTS,wBAAyB,CACvBC,OAAQ,+4DAER,KAAMF,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,gEAAiE,KAAMS,EAAAA,cAAoBZ,EAAYQ,IAAK,KAAMI,EAAAA,cAAoBZ,EAAYS,KAAM,CAC1OO,UAAW,mBACV,8UAAmV,KAAMJ,EAAAA,cAAoB,MAAO,KAAMA,EAAAA,cAAoBZ,EAAYG,EAAG,KAAMS,EAAAA,cAAoBZ,EAAYS,KAAM,KAAM,mBAAoB,kEAAmE,KAAMG,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,6EAA8E,KAAMS,EAAAA,cAAoBZ,EAAYG,EAAG,KAAM,sIACvtB,CAKA,MAJA,SAAoBJ,QAAK,IAALA,IAAAA,EAAQ,CAAC,GAC3B,MAAOkB,QAASC,GAAajB,OAAOC,OAAO,CAAC,GAAGQ,EAAAA,EAAAA,KAAsBX,EAAMY,YAC3E,OAAOO,EAAYN,EAAAA,cAAoBM,EAAWnB,EAAOa,EAAAA,cAAoBd,EAAmBC,IAAUD,EAAkBC,EAC9H,E,uCC9CA,MAAMY,EAAa,CACjBH,IAAKW,EAAAA,EACLV,KAAMW,EAAAA,GAEFC,EAAmBC,IAAgC,IAA/B,KAACC,EAAI,SAAEC,EAAQ,SAAEC,GAASH,EAClD,MAAMI,EAAOH,EAAKI,IAElB,OAAOf,EAAAA,cAAoBgB,EAAAA,EAAY,CACrCJ,SAAUA,EACVK,YAHgB,iBAIhBC,MAAOJ,EAAKK,YAAYD,MACxBE,YAAaN,EAAKK,YAAYC,aAAeN,EAAKO,QAClDC,KAAMR,EAAKK,YAAYG,KACvBC,KAAMT,EAAKK,YAAYI,MACtBvB,EAAAA,cAAoB,MAAO,CAC5BI,UAAWoB,EAAAA,GACXC,GAAI,aACJC,SAAU,eACT1B,EAAAA,cAAoB2B,EAAAA,EAAa,CAClC5B,WAAYA,GACXc,GAAWb,EAAAA,cAAoB4B,EAAAA,IAAW,EAGhC,SAASC,EAAiB1C,GACvC,OAAOa,EAAAA,cAAoBS,EAAkBtB,EAAOa,EAAAA,cAAoB8B,EAAqB3C,GAC/F,C","sources":["webpack://gatsby-starter-default/./posts/totp.mdx","webpack://gatsby-starter-default/./src/templates/blog-post.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    span: \"span\",\n    h3: \"h3\",\n    a: \"a\",\n    h4: \"h4\",\n    pre: \"pre\",\n    code: \"code\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.p, null, \"Basic Authentication (just username and password) has become increasingly insecure, as it can be easily compromised through phishing, brute force attacks, or data breaches. Let's face it: all systems have security flaws, but we should make it difficult for attackers.\"), \"\\n\", React.createElement(_components.p, null, \"So, what can we do? Well, we can do many things, but the easiest go-to answer is \\\"Multi-Factor Authentication\\\" (MFA).\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 861px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQ0lEQVR42o2T30tTYRjH95dE910HQbfdhBBGUBDdBUkQsqycQiUNRSGoLsRGBkm/0NymbdRR09LtnK08Tsdm0lo6wblN3UQ224+zHT9t53iscEFfeHnf5+F5v3y/z/u8pr29PWrIpNMIgoDHK1IoFPgTBzWZDB6PB1mWtRUIBAiFQoiiqMU1mIziGkksFiOzlURRFOqhUqmQSqWIRqNabWw1RiqZJB6Ps7GxYRCqqGpFC9bCAn5nOz+zW7oyVeV/YIj6S2G5mCU40c2759fYXI/sF6p1L6uqqq3dbJp8Pqflauo1wtSKj4i/n5DQgX/Uwue3Fhaneoh8eUE2EzNYDqnZ2U7wynqePvNpfizp/as5NcmCFa+jFXGkHa/9OtKwGdHZxozdTHR+8JAloz1j7pc8vHOOgVunsLU0UijmdIWSsxXJfgOf6zaz7zvxVYnEN81IjpsszvT+s1+ZzBZj9m5c1ga6Go8y+sSqE3qGW/jm62e2alUcbEIavEKwan/W3UHYYzuk0EBJKSGNP0V2NmO7epx7F09SLOYxTQ81sxpyEZ7oRHx9GWmoiYhkQx7rZsk/UIdQPyulXVwDZhwPLtDWcATLpROUaoRhbx+BqV6Ck/eZ/9DD16rNwOQjZKGL7eRiXYW1KCS7edx1lv67ZzA3HsP7ya1bzu1UhzIeZnnBQXJZJPH9I9GFETbX5qtzWK47d+WywozQS2p9ibnxZ8xNj/x+ZWPWdncS5HOb2q7sv1i93hl5RdG/ZzQ4STqxcpD/BU2cVh1ZBm3VAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"dog-mfa\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png\\\"\\n        srcset=\\\"/static/417717973f4fc39ca911b8d8f02100de/5a46d/mfa-dog.png 300w,\\n/static/417717973f4fc39ca911b8d8f02100de/0a47e/mfa-dog.png 600w,\\n/static/417717973f4fc39ca911b8d8f02100de/e35ec/mfa-dog.png 861w\\\"\\n        sizes=\\\"(max-width: 861px) 100vw, 861px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Attention ðŸš¨ - MFA is not a replacement for allowing users to create weak passwords.\"), \"\\n\", React.createElement(_components.p, null, \"There are multiple ways to enable MFA. Let's explore a few of them.\"), \"\\n\", React.createElement(_components.h3, null, \"Email Based OTP\"), \"\\n\", React.createElement(_components.p, null, \"An OTP will be delivered to the registered email. Accessibility is a pro here, as most users have an email account. However, you need to set up SMTP, store the OTP to validate it later, and be aware that emails can be compromised.\"), \"\\n\", React.createElement(_components.h3, null, \"Sms Based Otp\"), \"\\n\", React.createElement(_components.p, null, \"An OTP will be delivered to the registered mobile number. It's easy to use and poses a lesser security risk than email-based OTPs. But... there are high costs involved.\"), \"\\n\", React.createElement(_components.p, null, \"So, this leaves us to select a solution that should be cost-effective and easy to use.\"), \"\\n\", React.createElement(_components.h3, null, \"Introducing TOTP!!!\"), \"\\n\", React.createElement(_components.p, null, \"Time-Based One-Time Passwords (TOTP) are randomized numeric codes generated by authenticator apps like \", React.createElement(_components.a, {\n    href: \"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en\"\n  }, \"Google Authenticator\"), \" and \", React.createElement(_components.a, {\n    href: \"https://play.google.com/store/apps/details?id=com.azure.authenticator&hl=en\"\n  }, \"Microsoft Authenticator\"), \". These codes are generated based on a shared secret and a time counter, which means a new OTP is typically generated every 30 seconds. The OTP is valid only for the allotted time window, beyond which it becomes redundant, preventing OTP reuse.\"), \"\\n\", React.createElement(_components.h4, null, \"Fun Fact!\"), \"\\n\", React.createElement(_components.p, null, \"The first TOTP authentication system was developed, patented, and marketed by RSA Security. Later, the Initiative for Open Authentication (OATH) developed its own variant of TOTP, which it made freely available. I hope many of you have seen the image below ðŸ˜†\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 567px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADDklEQVR42h2S3U+bdRiG+zd44oEnHixLduCM07iZGIlOnJtkLOg255jZxK3MdQwLZUvD6Bh1VRS71WKtUFre8tLvljJoLbRQaPnoS2nQURiZgrTrYPsnLn9ycOfJc/DcuXI/t8psvovd3oMk/YrP308kMsjYmIdEIsTU1CizszHm5xIsLiTJ5VJ7WliYZH5+gkw2QXomzsTkGGOxCKERLyqr1YTTacHn6yMcdhGP+5mejpLJxFgUR3lliiVlmnx+hsLyLMt7mhF7GkVJMzefEqYJJpPjxGIjqOy//4Qs2wiFnCSEWSTixCN22W3D7+0nlYyyspJlrZjj8brCxnqetTWF1dVFHv2Vo1BYQFnKCtrUnqlqYOCBoOsnHvNht91Dd0vDJU0rVZ/e4P0vdOgMXQw47Qx5JBGJjD8wTCDowR8cxivk8Q8jDUuCcpJsZgqVJFkJh1xILjPfaM6jaWxCfaSOa4dO0fLaCT6sukJb1/d09/yIvrOTNoOBplt6NK03uaptQd10g9b2doKRAEouKwgdP9PTredS/Seor12m7tiXRA+8iVJ9lPSRdzlx8BzNxgcYuu7wxkc1vH70OPveqeLVQ4d5Zf8BXtq3nw9qT+KW3Sz+b2j6rg3rfQNn6t6jsbGBjz+7zuljak5XX+Vi/W3eOtVB8x0LFpuFr5q1qFt0nG1QU32ugaras9Qcr+FCw9c43ZJ40hyqXus9un9ox3i3mSuXz/CtvpO3z3fwcrWBgxfuU6u1Yu13EomGiSdiJCZiDIdGuGj08nmHyLTpJl3aDvpkWbRAQeV2/0Y0KpNKRTGZtGh1GnS3jdRfN9Ko78HmcIjg5T0FwwGRVZCAmLLXI54hMyhLSJ4hZrMzLBfyqFyuXgKBQcbHg6TTYwwN9WK2mLDZzUjuPsb/GGXjSZFy+W8qz7bY2dnm+e5TXryosPu8zLOdEqXSFmvrRZS8IHQ4fsHrdfJw1EcyOUpOlHUpnxHdyrBaLFAq/0Olsim0JY7/ZWd3W8wyTyvbbJc22dx8wuONIn8+WiGXV/gPnGVyF/I3QJcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"dog-mfa\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png\\\"\\n        srcset=\\\"/static/6b708138ce1112066c9bc2133d58fef3/5a46d/rsa.png 300w,\\n/static/6b708138ce1112066c9bc2133d58fef3/8710b/rsa.png 567w\\\"\\n        sizes=\\\"(max-width: 567px) 100vw, 567px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Let's see how we can implement one. I'm using C# here as an example, but it should\\nbe pretty much the same across platforms.\"), \"\\n\", React.createElement(_components.p, null, \"Below is the basic user journey for registration and authentication:\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 373px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 129.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADRUlEQVR42q1V7XaqMBD0/Z+t/dEPRUWFAIHwraKIVdm7sxRapb33z805aTCZbLI7M+mE/nOb4M/pdKLNxiWlfPL9gIIgpDTNR+C2banHh5GhMDSU58U44OVyIROnFCc5pVlB2+2edrvqLwEbDhhTUWypLHd3axN8XK9XzMgk+u12G/pjO5/Pgu9wV8F8fHzIpSQgJoIg4OtHMvq+T0mSkOd5ktb3Bmye56S1FpxSinQYkjGG92S83tIEkRFguVzS09MTvby80HQ65ZpuSHl6lDIOent7o/l8LuNsNqPFYkHrjeoCIoXD4SCFtiyL1uu1nNy2N/KDaKgNGlLNsryrOd8KB6dpKhjXDXj91tUwZkK0NuSqQE4KI07ZDyky6aiGIA1Yz9dk2w6nHMvBJs6+WO5b0zTM8D1rvzXcsiy3Yx1iI9JF6mVZcsobYa2fe6xhXx5gLWtBdX2Subquu4DYvFqthBiwF0WRjCj+fLHqQw0s92Q4jiOEoObT93eacXAJiKuDUQS17aVswGhZMx43dzcEKdvtliWmBf/8/Cx7y7KQul8uV5oAFImNIrllkmbyW+uISdIjHcZxwikeZbTtFbulpP2+oo3jy7qQgjocjw3lbCXDzB7rhqrqKPOPDXOwJSwHu1aHmm9d8f7TF8tfHq0pTTqptD/YrsdCoyAGmfRWHVjGD6SK2kRRyDVcCINZlomIH4MBd2J5lTw6jpJ0d7vdICEhZToFAbY4BcWGA15fX5m55aiGcAZ8DBV4nhJVdAoxQpoEBAi3CtnoCFYUhTwCwQ/W2+/3HCCWgC5LByxX1V5cNbCM4qZZySDNKdvyDYDywlHKxiSypkMj9gzZerAfFIH1zwf2yu64iBxgPXw3zVnM/thwAeDBdp6XggFe3tRHL8M+0ecb+C8vw5bQ7sjLiIyaVVUldVPKkzqBzZxF+5gysGAWo6vUgIUicAfxMswNmYA913WF6aaBzhJ5NL+nCzVgHX6Hj/HKw9cWK0JqiKsfjwcOWonZ4WUw2LZXCrS5Sx3fCKD4ULzSzifLwPtMkDyw0FbPXMyPZNdTCjUeTjNKGV4fcOwqKAR29fzo3nqIfgGD3PGN/hMxLZegx33v/b/RP3Ffyjb/MI5QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"mfa-flow\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png\\\"\\n        srcset=\\\"/static/4cc3ba47e58391a778550062601ba2c0/5a46d/mfa-flow.png 300w,\\n/static/4cc3ba47e58391a778550062601ba2c0/67a5d/mfa-flow.png 373w\\\"\\n        sizes=\\\"(max-width: 373px) 100vw, 373px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-csharp\"\n  }, \"using OtpNet;\\nusing QRCoder;\\n\")), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"We are using \", React.createElement(_components.a, {\n    href: \"https://github.com/kspearrin/Otp.NET?tab=readme-ov-file#totp-timed-one-time-password\"\n  }, \"otp.net\"), \"\\nand \", React.createElement(_components.a, {\n    href: \"https://github.com/codebude/QRCoder\"\n  }, \"QRCode\"), \" here\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-csharp\"\n  }, \"var secret = Base32Encoding.ToString(\\n                KeyGeneration.GenerateRandomKey(20)\\n                );\\n\")), \"\\n\", React.createElement(_components.p, null, React.createElement(\"br\"), \" The secret is generated using \", React.createElement(_components.code, null, \"KeyGeneration.GenerateRandomKey\"), \". I would\\nprefer one secret per user and store it securely after encrypting it using AES\\nor other popular algorithms.\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-csharp\"\n  }, \"\\nstring GenerateQrCodeUri(string email, string secret)\\n{\\nstring issuer = \\\"my amazing app\\\";\\nstring uri = $\\\"otpauth://totp/{issuer}:{email}?secret={secret}&issuer={issuer}\\\";\\n\\n    using (var qrGenerator = new QRCodeGenerator())\\n    {\\n    \\tvar qrCodeData = qrGenerator.CreateQrCode(uri, QRCodeGenerator.ECCLevel.Q);\\n    \\tvar qrCode = new Base64QRCode(qrCodeData);\\n    \\treturn qrCode.GetGraphic(20);\\n    }\\n\\n}\\n\\n\")), \"\\n\", React.createElement(_components.p, null, React.createElement(\"br\"), \" With the help of QRCoder, we can generate a QR code. Below is the output\\nfrom the above code, which you can scan using authenticator apps.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 541px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 97.66666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD5klEQVR42j1V5yv9URg/f4lXSkrKKxQhys5O9p4Z2Xvvlb33HhmRV0TIeGErvCQlm2Rmffw+j/rd+nbvPfec53k+61z18/OD+/t73Nzc4OnpCV9fX3h8fMT19TW+v7/x+fmJ5+dnvL6+yueHhwe8v7/L8/HxIeu3t7dynt8VD2ZkZCAuLg55eXno7u5GYWEh/Pz8sLS0hLCwMPk9Pj4eubm5MDQ0RE5ODnx9fRESEoKUlBRkZ2cjJiYGCwsLfwUzMzNhZWWF+vp6zM/PS3EW4rqXlxc8PDygpaWFqKgoaVZUVARtbW2kpqZienpa9vBZXl6GIsyamhqZrre3Fz09PdK1ra0NCQkJGB4eRm1trexxdHREbGws5ubmYGlpifz8fGxubmJwcBAlJSXY3t6Gent7Q1ZWFkZGRqSYubk50tLSpKCFhQWam5sRERGBwMBAuLu7IzExEXV1dTAxMcHQ0BDGx8fR19cnRc/Pz6FI7tTUFBoaGlBQUCAFRkdH5dDu7q5sZkOusSGhcXKiYGM28/b2RmtrK1ZWVqCoGqdxc3NDS0uLEN/V1YWtrS0pHh4ejvT0dKGkrKwMnZ2dAtnJyUk4JmxTU1MRjvDVxcWFLJKbiooKIbqjo0OKswAhbWxsoKqqCnZ2dkhKSoKRkRHGxsZQXFyMnZ0daRIcHCyIhMPFxUUZOSAgQN55mErz8PHxMdrb26UBiS8tLUVTUxPKy8txdHQk63t7e/J+d3f3xyEhcBO9Fh0dLRtZmELQMpWVlTINrWJmZibwKRCpoR+pPpsyFIpJIYfW1tbiL26YmZmRAyScMMgr+QoKCpIG9F5/f79AJxoXFxfo6+vj5OQE6vLyUkzs4OAgG/gjFSdkW1tbTExMSDN/f3+hhGuhoaEYGBiQxLAxLUO+hUPmj2rOzs6KxzQ0NIR8HR0dKZKcnCyxouc4Oe1D+IRJ6xgYGAhdtBmbKwafBLMboZFHZpPKOzs7S0KoPqcigsbGRrk4KBBRkAJGlrleW1uD4k1hb28PHx+f/4alBeg9QuUaI8n4kZrJyUkpzokiIyNlWj6urq5y4yj8e1E1eonmpMoUg4mgSOTM09NTLgUmiVbidNXV1SIM97EYmx8cHEC9vLyIguSHeeZhHuAUvMI4BbnlpKSAhXR1dYUSNmcsiYpc7+/vQ11dXUlBRo/cERJF4i3Dz1wjTxSI4tCbLEQK2JzXHgVicpg6uQ8Jg/KzMIUxNjaGnp6eTMXNmpqasLGxkfuQU1MMckx12YB2oqgMiURvfX1d8soI8e+A8JkecnJ4eChQeNednZ3JPvptdXUVp6enojjF4I1FgX8Bwncu4N1obTYAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"mfa-qr\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png\\\"\\n        srcset=\\\"/static/1f29c072d81b5d5a7d28e42c41e8859d/5a46d/mfa-qr.png 300w,\\n/static/1f29c072d81b5d5a7d28e42c41e8859d/9d576/mfa-qr.png 541w\\\"\\n        sizes=\\\"(max-width: 541px) 100vw, 541px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Once you have scanned the QR code, it will appear in authenticator apps like the one below. Oh yeah, the screenshot below is taken from the Chrome Google Authenticator extension.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 818px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABxElEQVR42o1Ti47aMBD0//9Mf6BSTyq05bhW4VpCgMLlSOJAnBd5OCThmO66KULqnVpLo3Xs9exjNuL+m4UgkHCfd0izHCpOECcpYrLbJxfL1YrsE35utoSN8UvSFEmWISa7oTs/CHCIFMaTKcSaHoVSEmkAXpfLZbAvcF0Xj48zrNdrOMsVLMsy5H/W+XyGpLdhGKJpNGZzG8JZ/EDX9dC6IWjopkHNllDX9e+zmz3boiiuqKoKZVmia1vM7QWEv12grGpEUYTDYW+iKRUhInAGXdeh73v0FNTYG5xOJ0N4PB5NMN/3IWxrioYuwlBChntIKp174lEpPVV/fqHy8fpiwjiOkVE/ee95HsT84ROSDpgrDStqMPJrjAONZdpiEpR4t0yxzU5DX99gHs6vhOz+ParxWWq8dwvc7Uo8hDV2RYuxV8LNXydkAa+g71gpiMVsakTwfQ+O48D3nrGn8kMZoKr1bQJ/JzZEsG0bKY1QTqWLr19GpocsAo/AgcRJEp7FmBTV6Kj5LQnTvQEWh3vISvM7Mfn4wWTIEVitPM+REfI8M2fs9C8wIUNRMuJ+dGfGhtXiy5T+kpQtkf0vksFfKYVfXr1Bt0hF+ewAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"mfa-auth\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png\\\"\\n        srcset=\\\"/static/325fb1a30674f08b7727b1d6b5727f76/5a46d/mfa-auth.png 300w,\\n/static/325fb1a30674f08b7727b1d6b5727f76/0a47e/mfa-auth.png 600w,\\n/static/325fb1a30674f08b7727b1d6b5727f76/64d87/mfa-auth.png 818w\\\"\\n        sizes=\\\"(max-width: 818px) 100vw, 818px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Now you have a time-based OTP. Let's see how to validate it.\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-csharp\"\n  }, \"var secret = \\\"my secure secret\\\";\\n\\nvar code = \\\"650260\\\";\\n\\nvar isValid = ValidateTotpCode(secret,code);\\n\\nisValid.Dump();\\n\\nbool ValidateTotpCode(string secret, string code)\\n{\\n\\tvar totp = new Totp(Base32Encoding.ToBytes(secret));\\n\\treturn totp.VerifyTotp(code, out long timeStepMatched, new VerificationWindow(2, 2));\\n}\\n\")), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.code, null, \"totp.VerifyTotp\"), \" will help us validate whether the input TOTP is valid or not.\"), \"\\n\", React.createElement(_components.p, null, \"Tada!!! With these easy steps, you have enabled MFA for your application.\"), \"\\n\", React.createElement(_components.p, null, \"Having MFA will not protect against impersonating cookies or JWTs. We will see how to make your JWT more secure in upcoming posts.\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/Users/fmarshooq/source/personal/fasilmarshooq.github.io/site/posts/totp.mdx\";\nimport * as React from \"react\";\nimport {graphql} from \"gatsby\";\nimport * as postStyles from \"../components/styles/post.module.css\";\nimport PostLayout from \"../components/post-layout\";\nimport {MDXProvider} from \"@mdx-js/react\";\nimport {InlineCode, CodeBlock} from \"../components/code-block\";\nimport Comments from \"../components/Comments/comments\";\nconst components = {\n  pre: CodeBlock,\n  code: InlineCode\n};\nconst BlogPostTemplate = ({data, location, children}) => {\n  const post = data.mdx;\n  const siteTitle = \"Fasil Marshooq\";\n  return React.createElement(PostLayout, {\n    location: location,\n    headerTitle: siteTitle,\n    title: post.frontmatter.title,\n    description: post.frontmatter.description || post.excerpt,\n    date: post.frontmatter.date,\n    tags: post.frontmatter.tags\n  }, React.createElement(\"div\", {\n    className: postStyles.content,\n    id: \"md-content\",\n    itemProp: \"articleBody\"\n  }, React.createElement(MDXProvider, {\n    components: components\n  }, children), React.createElement(Comments)));\n};\nBlogPostTemplate\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(BlogPostTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport const pageQuery = graphql`\n  query GetPost($id: String!) {\n    mdx(id: { eq: $id }) {\n      frontmatter {\n        title\n        date(formatString: \"MMMM DD, YYYY\")\n        tags\n      }\n    }\n  }\n`;\n"],"names":["_createMdxContent","props","_components","Object","assign","p","span","h3","a","h4","pre","code","_provideComponents","components","React","dangerouslySetInnerHTML","__html","href","className","wrapper","MDXLayout","CodeBlock","InlineCode","BlogPostTemplate","_ref","data","location","children","post","mdx","PostLayout","headerTitle","title","frontmatter","description","excerpt","date","tags","postStyles","id","itemProp","MDXProvider","Comments","GatsbyMDXWrapper","GATSBY_COMPILED_MDX"],"sourceRoot":""}